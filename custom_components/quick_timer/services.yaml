run_action:
  name: Run Action
  description: Schedule a one-time timer with optional immediate actions and delayed completion actions.
  fields:
    task_id:
      name: Task ID
      description: Unique identifier for this timer task. Allows multiple timers per entity. If omitted, entity_id will be used (legacy mode).
      required: false
      example: "card_abc123"
      selector:
        text:
    entity_id:
      name: Entity (Legacy)
      description: For backward compatibility. Use finish_actions instead for multi-target support.
      required: false
      example: "light.living_room"
      selector:
        entity:
    delay:
      name: Delay
      description: The delay before finish actions are executed (1-86400 depending on unit). Required when using relative time mode.
      required: false
      example: 30
      default: 15
      selector:
        number:
          min: 1
          max: 86400
          mode: box
    unit:
      name: Time Unit
      description: The unit of time for the delay (seconds, minutes, hours).
      required: false
      example: "minutes"
      default: "minutes"
      selector:
        select:
          options:
            - label: "Seconds"
              value: "seconds"
            - label: "Minutes"
              value: "minutes"
            - label: "Hours"
              value: "hours"
    time_mode:
      name: Time Mode
      description: Whether to use relative delay or absolute time.
      required: false
      example: "relative"
      default: "relative"
      selector:
        select:
          options:
            - label: "Relative (delay)"
              value: "relative"
            - label: "Absolute (specific time)"
              value: "absolute"
    at_time:
      name: At Time
      description: The specific time to execute finish actions (HH:MM format). Required when using absolute time mode. If the time is in the past, it will be scheduled for the next day.
      required: false
      example: "23:30"
      selector:
        time:
    start_actions:
      name: Start Actions (Optional)
      description: List of actions to execute immediately when timer starts. Each action must have 'service', 'target', and optionally 'data'.
      required: false
      example: '[{"service": "light.turn_on", "target": {"entity_id": "light.bedroom"}, "data": {"brightness": 255}}]'
      selector:
        object:
    task_label:
      name: Task Label
      description: A human-readable label for this timer task, shown in the overview card. If omitted, the entity name or card ID is used.
      required: false
      example: "Kitchen light timer"
      selector:
        text:
    finish_actions:
      name: Finish Actions
      description: List of actions to execute when timer completes. Each action must have 'service', 'target', and optionally 'data'.
      required: false
      example: '[{"service": "light.turn_off", "target": {"entity_id": "light.bedroom"}}]'
      selector:
        object:
    notify_ha:
      name: HA Notification
      description: Whether to send a persistent notification in Home Assistant when the timer completes.
      required: false
      example: false
      default: false
      selector:
        boolean:
    notify_mobile:
      name: Mobile Notification
      description: Whether to send push notifications to all mobile devices when the timer completes. Use notify_devices for specific devices.
      required: false
      example: false
      default: false
      selector:
        boolean:
    notify_devices:
      name: Notify Devices
      description: List of specific mobile device IDs to send push notifications to. Overrides notify_mobile when provided.
      required: false
      example: '["device_id_1", "device_id_2"]'
      selector:
        device:
          filter:
            - integration: mobile_app
          multiple: true

cancel_action:
  name: Cancel Action
  description: Cancel a scheduled timer task.
  fields:
    task_id:
      name: Task ID
      description: The unique task ID to cancel. If omitted, entity_id will be used (legacy mode).
      required: false
      example: "card_abc123"
      selector:
        text:
    entity_id:
      name: Entity (Legacy)
      description: The entity to cancel the scheduled task for. Used when task_id is not provided.
      required: false
      example: "light.living_room"
      selector:
        entity:

get_preferences:
  name: Get Preferences
  description: Get saved preferences and history for an entity or all entities.
  fields:
    entity_id:
      name: Entity
      description: The entity to get preferences for. If omitted, returns all preferences.
      required: false
      example: "light.living_room"
      selector:
        entity:

set_preferences:
  name: Set Preferences
  description: Set preferences for an entity.
  fields:
    entity_id:
      name: Entity
      description: The entity to set preferences for.
      required: true
      example: "light.living_room"
      selector:
        entity:
    preferences:
      name: Preferences
      description: The preferences object to store.
      required: true
      example: '{"last_action": "off", "last_delay": 15, "last_unit": "minutes"}'
      selector:
        object:
